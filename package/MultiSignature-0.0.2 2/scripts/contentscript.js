"use strict";var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.CLASS_NAME_PREFIX="autocharlie-material-content-",autocharlie.constants.ClassName={MODAL_HEADER:autocharlie.constants.CLASS_NAME_PREFIX+"header",MODAL_FOOTER:autocharlie.constants.CLASS_NAME_PREFIX+"footer",MODAL_CONTENT:autocharlie.constants.CLASS_NAME_PREFIX+"content",MODAL_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"container",FAB:autocharlie.constants.CLASS_NAME_PREFIX+"fab",CARD:autocharlie.constants.CLASS_NAME_PREFIX+"card",LIGHT_BOX:autocharlie.constants.CLASS_NAME_PREFIX+"lightbox",DARK_BOX:autocharlie.constants.CLASS_NAME_PREFIX+"darkbox",BUTTON:autocharlie.constants.CLASS_NAME_PREFIX+"button",LEFT_ICON_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"left-icon-container",RIGHT_ICON_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"right-icon-container",INNER_HEADER:autocharlie.constants.CLASS_NAME_PREFIX+"inner-header",RIGHT_ICON:autocharlie.constants.CLASS_NAME_PREFIX+"right-icon",LEFT_ICON:autocharlie.constants.CLASS_NAME_PREFIX+"left-icon",TABS_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs",TAB:autocharlie.constants.CLASS_NAME_PREFIX+"tab",TAB_INDICATOR:autocharlie.constants.CLASS_NAME_PREFIX+"tab-indicator",TABS_DIVS_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div-container",TABS_DIV:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div",TABS_DIVS_INNER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div-inner",PADDING:autocharlie.constants.CLASS_NAME_PREFIX+"padding"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Copy={SUBMIT_FEEDBACK:"Submit Feedback",SEND:"Send",FEEDBACK:"Feedback",EMAIL_ADDRESS:"Email Address"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.ID_NAME_PREFIX="autocharlie-material-content-",autocharlie.constants.Id={HEADER_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"header",FOOTER_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"footer",CONTENT_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"content",FEEBACK_INPUT:autocharlie.constants.ID_NAME_PREFIX+"feedback-input",FEEBACK_EMAIL:autocharlie.constants.ID_NAME_PREFIX+"feedback-email"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.IMAGE_FOLDER="images/",autocharlie.constants.Images={HEADER_LOGO:autocharlie.constants.IMAGE_FOLDER+"Logo.png",HEADER_HAMBURGER:autocharlie.constants.IMAGE_FOLDER+"Header_Hamburger.png",HEADER_CLOSE:autocharlie.constants.IMAGE_FOLDER+"Header_Close.png",HEADER_FEEDBACK:autocharlie.constants.IMAGE_FOLDER+"Header_Feedback.png"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Message={SEND_FEEDBACK:"sendFeedback"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Names={APP:"MultiSignature"};var autocharlie=autocharlie||{};autocharlie.services=autocharlie.services||{},autocharlie.services.PasteInterceptor=function(t,e,i){this.elem=t,this.callback=e,this.propagate=i||!1},autocharlie.services.PasteInterceptor.prototype.addEventListener=function(){this.elem.addEventListener("paste",function(t){this.propagate||t.preventDefault();var e=(t.originalEvent||t).clipboardData.getData("text/html")||"";this.callback(e)}.bind(this),!1)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Container=function(t){return this.containerDiv=document.createElement("div"),this.header=new autocharlie.ui.Header(this),this.content=new autocharlie.ui.Content(this),this.footer=new autocharlie.ui.Footer(this),this.containerDiv.className=autocharlie.constants.ClassName.MODAL_CONTAINER,t.appendChild(this.containerDiv),this.header.init(),this.content.init(),this.footer.init(),this.header.setHeader(autocharlie.constants.Names.APP),this},autocharlie.ui.Container.prototype.show=function(){this.containerDiv.style.display="block"},autocharlie.ui.Container.prototype.hide=function(){this.containerDiv.style.display="none"},autocharlie.ui.Container.prototype.get=function(){return this.containerDiv},autocharlie.ui.Container.prototype.getHeader=function(){return this.header},autocharlie.ui.Container.prototype.getContent=function(){return this.content},autocharlie.ui.Container.prototype.getFooter=function(){return this.footer};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Content=function(t){this.parent=t},autocharlie.ui.Content.prototype.clear=function(){return this.content.innerHTML="",this.content},autocharlie.ui.Content.prototype.remove=function(){this.content.parentNode.removeChild(this.content)},autocharlie.ui.Content.prototype.get=function(){return this.content},autocharlie.ui.Content.prototype.show=function(){this.content.style.display="block"},autocharlie.ui.Content.prototype.hide=function(){this.content.style.display="none"},autocharlie.ui.Content.prototype.init=function(){this.content=document.createElement("div"),this.content.className=autocharlie.constants.ClassName.MODAL_CONTENT,this.parent.get().appendChild(this.content)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Fab=function(t){this.parent=t},autocharlie.ui.Fab.prototype.clear=function(){return this.content.innerHTML="",this.content},autocharlie.ui.Fab.prototype.remove=function(){this.content.parentNode.removeChild(this.content)},autocharlie.ui.Fab.prototype.get=function(){return this.content},autocharlie.ui.Fab.prototype.show=function(){this.content.style.display="block"},autocharlie.ui.Fab.prototype.hide=function(){this.content.style.display="none"},autocharlie.ui.Fab.prototype.init=function(t){this.content=document.createElement("div"),this.content.innerHTML="+",this.content.className=autocharlie.constants.ClassName.FAB,this.parent.get().appendChild(this.content),t&&this.content.addEventListener("click",t,!1)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Footer=function(t){this.parent=t},autocharlie.ui.Footer.prototype.clear=function(){return this.modalFooter.innerHTML="",this.modalFooter},autocharlie.ui.Footer.prototype.remove=function(){this.modalFooter.parentNode.removeChild(this.modalFooter)},autocharlie.ui.Footer.prototype.get=function(){return this.modalFooter},autocharlie.ui.Footer.prototype.show=function(){this.modalFooter.style.display="block"},autocharlie.ui.Footer.prototype.hide=function(){this.modalFooter.style.display="none"},autocharlie.ui.Footer.prototype.init=function(){this.modalFooter=document.createElement("div"),this.modalFooter.className=autocharlie.constants.ClassName.MODAL_FOOTER,this.modalFooter.id=autocharlie.constants.Id.FOOTER_CONTAINER,this.parent.get().appendChild(this.modalFooter)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Header=function(t){this.parent=t},autocharlie.ui.Header.prototype.clear=function(){return this.innerHeader.innerHTML="",this.clearIcons(),this.header},autocharlie.ui.Header.prototype.remove=function(){this.header.parentNode.removeChild(this.header)},autocharlie.ui.Header.prototype.setHeader=function(t){if(t===autocharlie.constants.Names.APP){this.innerHeader.innerHTML="";var e=document.createElement("img");e.src=chrome.extension.getURL(autocharlie.constants.Images.HEADER_LOGO),this.innerHeader.appendChild(e)}else this.innerHeader.innerHTML=t;return this.header},autocharlie.ui.Header.prototype.clearIcons=function(){this.leftIcons.innerHTML="",this.rightIcons.innerHTML=""},autocharlie.ui.Header.prototype.addMenuBtn=function(t){this.addLeftIcon(autocharlie.constants.Images.HAMBURGER,t)},autocharlie.ui.Header.prototype.addLeftIcon=function(t,e,i){var a=document.createElement("img"),n="";return i&&(n+=" "+i),a.className=autocharlie.constants.ClassName.LEFT_ICON+n,a.src=chrome.extension.getURL(t),a.addEventListener("click",e),this.leftIcons.appendChild(a),a},autocharlie.ui.Header.prototype.addCloseButton=function(t){return this.addLeftIcon(autocharlie.constants.Images.HEADER_CLOSE,t)},autocharlie.ui.Header.prototype.addFeedbackButton=function(){this.addRightIcon(autocharlie.constants.Images.HEADER_FEEDBACK,function(){this.lightbox=new autocharlie.ui.LightBox(this.parent.get());var t=document.createElement("div");console.log("ids"),console.log(autocharlie.constants.Id);var e=new autocharlie.ui.Input(autocharlie.constants.Copy.FEEDBACK,autocharlie.constants.Id.FEEDBACK_INPUT);t.appendChild(e.get());var i=new autocharlie.ui.Input(autocharlie.constants.Copy.EMAIL_ADDRESS,autocharlie.constants.Id.FEEDBACK_EMAIL);t.appendChild(i.get());var a=document.createElement("button");a.className=autocharlie.constants.ClassName.BUTTON,a.innerHTML=autocharlie.constants.Copy.SEND,a.addEventListener("click",function(){var t=document.getElementById(autocharlie.constants.Id.FEEDBACK_EMAIL).value;console.log(t);var e=document.getElementById(autocharlie.constants.Id.FEEDBACK_INPUT).value,i={email:t,feedback:e};console.log(i),chrome.runtime.sendMessage({method:autocharlie.constants.Message.SEND_FEEDBACK,feedback:i},function(t){this.lightbox.remove()}.bind(this))}.bind(this),!1),t.appendChild(a),this.lightbox.init(t,multisig.Content.Copy.SUBMIT_FEEDBACK)}.bind(this))},autocharlie.ui.Header.prototype.addRightIcon=function(t,e,i){var a=document.createElement("img"),n="";return i&&(n+=" "+i),a.className=autocharlie.constants.ClassName.RIGHT_ICON+n,a.src=chrome.extension.getURL(t),a.addEventListener("click",e),this.rightIcons.appendChild(a),a},autocharlie.ui.Header.prototype.init=function(){this.header=document.createElement("div"),this.header.className=autocharlie.constants.ClassName.MODAL_HEADER,this.header.id=autocharlie.constants.Id.HEADER_CONTAINER,this.parent.get().appendChild(this.header),this.leftIcons=document.createElement("div"),this.leftIcons.className=autocharlie.constants.ClassName.LEFT_ICON_CONTAINER,this.leftIcons.id=autocharlie.constants.Id.HEADER_LEFT_ICONS,this.header.appendChild(this.leftIcons),this.innerHeader=document.createElement("div"),this.innerHeader.className=autocharlie.constants.ClassName.INNER_HEADER,this.innerHeader.id=autocharlie.constants.Id.INNER_HEADER,this.header.appendChild(this.innerHeader),this.rightIcons=document.createElement("div"),this.rightIcons.className=autocharlie.constants.ClassName.RIGHT_ICON_CONTAINER,this.rightIcons.id=autocharlie.constants.Id.HEADER_RIGHT_ICONS,this.header.appendChild(this.rightIcons)},autocharlie.ui.Header.prototype.get=function(){return this.header};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Input=function(t,e){return this.placeholder=t,this.container=document.createElement("div"),this.id=e,this.init(),this},autocharlie.ui.Input.ClassName={CONTAINER:"auto-char-input-container",LABEL:"auto-char-input-label",INPUT:"auto-char-input-input",FOCUSED:"auto-char-input-container-focused"},autocharlie.ui.Input.prototype.init=function(){this.container.className=autocharlie.ui.Input.ClassName.CONTAINER,this.container.innerHTML="",this.label=document.createElement("label"),this.label.className=autocharlie.ui.Input.ClassName.LABEL,this.label.innerHTML=this.placeholder,this.container.appendChild(this.label),this.input=document.createElement("input"),this.input.className=autocharlie.ui.Input.ClassName.INPUT,console.log("id is"),console.log(this.id),this.id&&(console.log("here"),this.input.id=this.id),this.container.appendChild(this.input)},autocharlie.ui.Input.prototype.get=function(){return this.container},autocharlie.ui.Input.prototype.getInput=function(){return this.input};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.LightBox=function(t,e,i){return this.container=t,this.closeCallback=e,this.darkBoxHide=i||!0,this},autocharlie.ui.LightBox.prototype.get=function(){return this.lightBox},autocharlie.ui.LightBox.prototype.show=function(){this.modalFooter.style.display="block"},autocharlie.ui.LightBox.prototype.remove=function(){this.container.removeChild(this.darkBox),this.container.removeChild(this.lightBox),this.closeCallback&&this.closeCallback()},autocharlie.ui.LightBox.prototype.init=function(t,e){this.lightBox=document.createElement("div"),this.lightBox.className=autocharlie.constants.ClassName.LIGHT_BOX,this.container.appendChild(this.lightBox),console.log(e),e&&""!==e&&(this.header=document.createElement("h3"),this.headerText=document.createElement("div"),this.headerText.innerHTML=e,this.header.appendChild(this.headerText),this.lightBox.appendChild(this.header)),t&&this.lightBox.appendChild(t),this.darkBox=document.createElement("div"),this.darkBox.className=autocharlie.constants.ClassName.DARK_BOX,this.darkBoxHide&&this.darkBox.addEventListener("click",function(){this.remove()}.bind(this),!1),this.container.appendChild(this.darkBox)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Tabs=function(t,e){this.insertionDiv=t,this.tabDetails=e,this.tabsContainer=document.createElement("ul"),this.tabsContainer.className=autocharlie.constants.ClassName.TABS_CONTAINER;for(var i=0;i<this.tabDetails.length;i++)this.createTabButton(i);this.indicator=document.createElement("div"),this.indicator.className=autocharlie.constants.ClassName.TAB_INDICATOR,this.indicator.style.width=100/this.tabDetails.length+"%",this.indicator.style.left="0px",this.tabsContainer.appendChild(this.indicator),this.insertionDiv.appendChild(this.tabsContainer),this.tabsDivContainer=document.createElement("div"),this.tabsDivContainer.className=autocharlie.constants.ClassName.TABS_DIVS_CONTAINER,this.tabsDivContainer.style.width="100%",this.tabsInnerDivContainer=document.createElement("div"),this.tabsInnerDivContainer.className=autocharlie.constants.ClassName.TABS_DIVS_INNER,this.tabsInnerDivContainer.style.width=100*e.length+"%",this.tabsDivContainer.appendChild(this.tabsInnerDivContainer);for(var a=0;a<e.length;a++){var n=e[a],o=document.createElement("div");e[a].containerDiv=o,o.className=autocharlie.constants.ClassName.TABS_DIV,o.appendChild(n.div),o.style.width=100/e.length+"%",o.style.left="0%",this.tabsInnerDivContainer.appendChild(o)}this.insertionDiv.appendChild(this.tabsDivContainer)},autocharlie.ui.Tabs.prototype.createTabButton=function(t){var e=this.tabDetails[t],i=document.createElement("li");this.tabDetails.button=i,i.className=autocharlie.constants.ClassName.TAB,i.innerHTML=e.name,i.style.width=100/this.tabDetails.length+"%",this.tabsContainer.appendChild(i),i.addEventListener("click",function(){var e=t*(100/this.tabDetails.length);this.indicator.style.left=e+"%";var i=t*(100/this.tabDetails.length);this.tabsInnerDivContainer.style.transform="translate3d(-"+i+"%, 0px, 0px)"}.bind(this))};var multisig=multisig||{};multisig.constants=multisig.constants||{},multisig.constants.Message={GET_SIGNATURES:"getSignatures",CREATE_SIGNATURE:"createSignature",EDIT_SIGNATURE:"editSignature",DELETE_SIGNATURE:"deleteSignature",GET_RULES:"getRules",CREATE_RULE:"createRule",EDIT_RULE:"editRule",DELETE_RULE:"deleteRule",SEND_FEEDBACK:"sendFeedback"};var multisig=multisig||{};multisig.controllers=multisig.controllers||{},multisig.controllers.HomeCtrl=function(t){this.container=t.container,this.parent=t,this.content=this.container.getContent(),this.currentMessage=t.currentMessage,this.signatureList=null,console.log("Home Ctrl"),console.log(t),console.log(t.currentMessage)},multisig.controllers.HomeCtrl.Copy={NO_SIGNATURES:"There are no signatures, add one with the plus below",COPY_PASTE_SIGNATURE:"You can also paste in the box above",ADD_SIGNATURE:"Add Signature",SIGNATURE_NAME:"Signature Name",USE:"Use",EDIT:"Edit",DELETE:"Delete",CREATE:"Create"},multisig.controllers.HomeCtrl.TOOLBAR_HTML='<a class="wysiw-button" data-wysihtml5-command="bold" title="CTRL+B"><b>B</b></a> <a class="wysiw-button" data-wysihtml5-command="italic" title="CTRL+I"><i>I</i></a> <a class="wysiw-button" data-wysihtml5-command="createLink">link</a><a class="wysiw-button" data-wysihtml5-command="insertImage">image</a><a class="wysiw-button" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1">header</a> |<a class="wysiw-button" data-wysihtml5-command="insertSpeech">speech</a><a class="wysiw-button" data-wysihtml5-action="change_view">HTML Mode</a><div data-wysihtml5-dialog="createLink" style="display: none;"><label> Link: <input data-wysihtml5-dialog-field="href" value="http://"></label><a data-wysihtml5-dialog-action="save">OK</a>&nbsp;<a data-wysihtml5-dialog-action="cancel">Cancel</a></div><div data-wysihtml5-dialog="insertImage" style="display: none;"> <label>Image:<input data-wysihtml5-dialog-field="src" value="http://"></label><label>Align:<select data-wysihtml5-dialog-field="className"><option value="">default</option><option value="wysiwyg-float-left">left</option><option value="wysiwyg-float-right">right</option></select></label><a data-wysihtml5-dialog-action="save">OK</a>&nbsp;<a data-wysihtml5-dialog-action="cancel">Cancel</a></div>',multisig.controllers.HomeCtrl.prototype.init=function(){this.signatureList=document.createElement("div"),this.signatureList.className=autocharlie.constants.ClassName.PADDING;var t=document.createElement("div");t.className=autocharlie.constants.ClassName.PADDING,t.innerHTML=multisig.Constants.Copy.RULES_PREVIEW;var e=[{name:multisig.Constants.Copy.SIGNATURES,div:this.signatureList,active:!0},{name:multisig.Constants.Copy.RULES,div:t,active:!1}];new autocharlie.ui.Tabs(this.content.get(),e);this.getCurrentSignatures(this.signatureList),this.fab=new autocharlie.ui.Fab(this.container),this.fab.init(this.createSignatureUI.bind(this))},multisig.controllers.HomeCtrl.prototype.getCurrentSignatures=function(t){console.log("Supposed to be getting Sigs"),console.log(multisig.constants.Message.GET_SIGNATURES),chrome.runtime.sendMessage({method:multisig.constants.Message.GET_SIGNATURES},function(e){if(console.log("Got Response"),console.log(e),e&&e.length>0)for(var i=0;i<e.length;i++)console.log(e[i]),this.createSignatureBox(e[i],t);else console.log("No Signatures"),t.innerHTML=multisig.controllers.HomeCtrl.Copy.NO_SIGNATURES}.bind(this))},multisig.controllers.HomeCtrl.prototype.createSignatureBox=function(t,e){this.content.get().innerHTML===multisig.controllers.HomeCtrl.Copy.NO_SIGNATURES&&(e.innerHTML="");var i=document.createElement("div");i.className=autocharlie.constants.ClassName.CARD;var a=document.createElement("h3");a.innerHTML=t.name,i.appendChild(a);var n=document.createElement("div");n.innerHTML=t.html,n.className=multisig.Constants.ClassName.SIG_HTML,i.appendChild(n);var o=document.createElement("button");o.className=autocharlie.constants.ClassName.BUTTON,o.innerHTML=multisig.controllers.HomeCtrl.Copy.USE,o.addEventListener("click",function(){this.useSignature(t)}.bind(this),!1),i.appendChild(o);var s=document.createElement("button");s.className=autocharlie.constants.ClassName.BUTTON,s.innerHTML=multisig.controllers.HomeCtrl.Copy.EDIT,s.addEventListener("click",function(){this.editSignature(t)}.bind(this),!1),i.appendChild(s);var l=document.createElement("button");l.className=autocharlie.constants.ClassName.BUTTON,l.innerHTML=multisig.controllers.HomeCtrl.Copy.DELETE,l.addEventListener("click",function(e){this.deleteSignature(t,e.target)}.bind(this),!1),i.appendChild(l),e.appendChild(i)},multisig.controllers.HomeCtrl.prototype.useSignature=function(t){console.log("Using Signature"),console.log(this),console.log(this.parent),console.log(this.parent.currentMessage),console.log(this);var e=this.parent.currentMessage,i=this.parent.platformDetails,a=e.querySelector(i.signatureContainer);if(console.log(a),console.log(e),console.log(i.signatureContainer),console.log("html"),console.log(t.html),a)console.log("Found Signature"),a.innerHTML=t.html;else{var n=document.createElement("div");n.innerHTML=t.html,n.className=i.signatureClass,e.appendChild(n)}},multisig.controllers.HomeCtrl.prototype.editSignature=function(t){},multisig.controllers.HomeCtrl.prototype.deleteSignature=function(t,e){console.log(multisig.constants.Message.DELETE_SIGNATURE),console.log(t),chrome.runtime.sendMessage({method:multisig.constants.Message.DELETE_SIGNATURE,signature:t},function(t){console.log("Response"),console.log(t),"success"===t.status&&e.parentNode.parentNode.removeChild(e.parentNode)}.bind(this))},multisig.controllers.HomeCtrl.prototype.createSignatureUI=function(){this.lightbox=new autocharlie.ui.LightBox(this.container.get());var t=document.createElement("div");t.style.padding="10px";var e=new autocharlie.ui.Input(multisig.controllers.HomeCtrl.Copy.SIGNATURE_NAME);t.appendChild(e.get()),console.log("1");var i=document.createElement("div");i.id=multisig.constants.Ids.TOOLBAR,i.style.display="none",console.log("2"),i.innerHTML=multisig.controllers.HomeCtrl.TOOLBAR_HTML,console.log("3"),t.appendChild(i),console.log("5");var a=document.createElement("textarea");a.id=multisig.constants.Ids.TEXTAREA,t.appendChild(a);var n=document.createElement("p");n.innerHTML=multisig.controllers.HomeCtrl.Copy.COPY_PASTE_SIGNATURE,t.appendChild(n);var o=document.createElement("button");o.className=autocharlie.constants.ClassName.BUTTON,o.innerHTML=multisig.controllers.HomeCtrl.Copy.CREATE,t.appendChild(o),o.addEventListener("click",function(){var t={name:e.getInput().value,html:a.value};chrome.runtime.sendMessage({method:multisig.constants.Message.CREATE_SIGNATURE,signature:t},function(e){"success"===e.status?(console.log("Worked!"),this.createSignatureBox(t,this.signatureList),this.lightbox.remove()):console.log("Error")}.bind(this))}.bind(this),!1),this.lightbox.init(t,multisig.controllers.HomeCtrl.Copy.ADD_SIGNATURE),console.log(multisig.constants.Ids.TEXTAREA),console.log(document.getElementById(multisig.constants.Ids.TEXTAREA)),console.log(multisig.constants.Ids.TOOLBAR),console.log(document.getElementById(multisig.constants.Ids.TOOLBAR));new wysihtml5.Editor(multisig.constants.Ids.TEXTAREA,{toolbar:multisig.constants.Ids.TOOLBAR,stylesheets:"css/stylesheet.css",parserRules:wysihtml5ParserRules})},multisig.controllers.HomeCtrl.prototype.createRuleUI=function(){},multisig.controllers.HomeCtrl.prototype.editRule=function(){},multisig.controllers.HomeCtrl.prototype.deleteRule=function(){};var multisig=multisig||{};multisig.Constants=multisig.Constants||{},multisig.Constants.CLASS_NAME_PREFIX="multi-sig-ext-",multisig.Constants.ClassName={EXAMPLE:"example",SIG_HTML:multisig.Constants.CLASS_NAME_PREFIX+"sig-html"};var multisig=multisig||{};multisig.Constants=multisig.Constants||{},multisig.Constants.Copy={SIGNATURES:"Signatures",RULES:"Rules",RULES_PREVIEW:"Here you will be able to set rules as to which signature to use when.This is currently in development, if you are interested in this feature please message us using the feedback button in the top right with what you would like rules to do."};var multisig=multisig||{};multisig.Constants=multisig.Constants||{},multisig.Constants.ID_PREFIX="multi-sig-ext-",multisig.constants.Ids={TOOLBAR:multisig.Constants.CLASS_NAME_PREFIX+"toobar",TEXTAREA:multisig.Constants.CLASS_NAME_PREFIX+"textarea"};var multisig=multisig||{};multisig.Constants=multisig.Constants||{},multisig.Constants.IMAGE_DIRECTORY="images/",multisig.Constants.Images={HEADER_LOGO:multisig.Constants.IMAGE_DIRECTORY+"Logo.png"};var multisig=multisig||{};console.log("1"),multisig.Content=function(){this.showing=!1},multisig.Content.Copy={SUBMIT_FEEDBACK:"Submit Feedback"},multisig.Content.Modes={GMAIL:"Gmail"},multisig.Content.URL_CHECKS=[{platform:multisig.Content.Modes.GMAIL,regex:"https://mail.google.com/*"}],multisig.Content.InsertionType={BEFORE:"Before",AFTER:"After"},multisig.Content.UniqueButtonAttributes={ATTRIBUTE:"MultiSig",VALUE:"Button"},multisig.Content.PLATFORM_DETAILS=[{platform:multisig.Content.Modes.GMAIL,outerContainer:{attribute:"name",value:"composeid",parents:2},messageBodySelector:'[aria-label="Message Body"]',messageBodyElementNumber:1,similarButtonSelector:'[data-tooltip="Formatting options"]',useParentLevel:!0,elementType:"td",insertionType:multisig.Content.InsertionType.AFTER,includeClasses:!0,containerClass:"multi-sig-ext-gmail-button",containerInnerHtml:"<img src="+chrome.extension.getURL("images/icon-16.png")+"></div>",signatureContainer:".gmail_signature",signatureClass:"gmail_signature",toInputs:{attribute:"name",value:"to",type:"input",email:"value"},ccInputs:{attribute:"name",value:"cc",type:"input",email:"value"},bccInputs:{attribute:"name",value:"bcc",type:"input",email:"value"}}],multisig.Content.ATTEMPTS=5,multisig.Content.WAIT_TIME=500,multisig.Content.prototype.init=function(){this.shouldLoad()&&(this.decideMode(),this.scrappedBody=document.getElementsByTagName("body")[0],this.addComposeListener(),this.container=new autocharlie.ui.Container(this.scrappedBody),this.ctrl=new multisig.controllers.HomeCtrl(this),this.ctrl.init(),this.container.header.addFeedbackButton(),this.container.header.addCloseButton(this.hide.bind(this)))},multisig.Content.prototype.toggle=function(t){t&&t.stopPropagation(),this.showing?this.hide():this.show()},multisig.Content.prototype.show=function(){this.showing=!0,this.container.show()},multisig.Content.prototype.hide=function(){this.showing=!1,this.container.hide()},multisig.Content.prototype.decideMode=function(){this.platform=multisig.Content.Modes.GMAIL;for(var t=0;t<multisig.Content.PLATFORM_DETAILS.length;t++){var e=multisig.Content.PLATFORM_DETAILS[t];e.platform===this.platform&&(this.platformDetails=e)}},multisig.Content.prototype.shouldLoad=function(){return!0},multisig.Content.prototype.checkLoad=function(){document.addEventListener("DOMContentLoaded",this.init.bind(this),!1)},multisig.Content.prototype.addComposeListener=function(){document.addEventListener("DOMNodeInserted",this.subtreeModifed.bind(this),!1)},multisig.Content.prototype.subtreeModifed=function(t){var e=t.target;this.checkComposeAdded(e),this.checkEmailChanges(e)},multisig.Content.prototype.checkComposeAdded=function(t){var e=this.platformDetails.outerContainer;if(t&&t.getAttribute){var i=t.getAttribute(e.attribute);if(i===e.value)t=this.getParents(t,e.parents),this.getMessageBody(t);else{var a=t.querySelector("["+e.attribute+'="'+e.value+'"]');a&&(a=this.getParents(a,e.parents),this.getMessageBody(a))}}},multisig.Content.prototype.checkEmailChanges=function(t){if(t&&t.querySelector){var e=t.querySelector(this.platformDetails.toInputs.type+"["+this.platformDetails.toInputs.attribute+'="'+this.platformDetails.toInputs.value+'"]');if(e){var i=e.getAttribute(this.platformDetails.toInputs.email);console.log("Found Email"),console.log(i)}}},multisig.Content.prototype.getParents=function(t,e){var i=t;if(e>0)for(var a=0;e>a;a++)i=i.parentNode;return i},multisig.Content.prototype.addInputListener=function(){},multisig.Content.prototype.getMessageBody=function(t,e){var i=e||multisig.Content.ATTEMPTS,a=t.querySelectorAll(this.platformDetails.messageBodySelector)[this.platformDetails.messageBodyElementNumber];a&&null!==a&&""!==a?this.addToButtons(t,a):window.setTimeout(function(){i--,i>0&&this.getMessageBody(t,i)}.bind(this),multisig.Content.WAIT_TIME)},multisig.Content.prototype.addToButtons=function(t,e,i){var a=i||multisig.Content.ATTEMPTS,n=t.querySelector(this.platformDetails.similarButtonSelector);t.querySelectorAll(this.platformDetails.similarButtonSelector);if(this.platformDetails.useParentLevel&&n&&null!==n&&""!==n&&(n=n.parentNode),n&&null!==n&&""!==n&&n.parentNode.getElementsByClassName(this.platformDetails.containerClass).length<1){var o=document.createElement(this.platformDetails.elementType);o.innerHTML=this.platformDetails.containerInnerHtml,o.addEventListener("click",function(){this.toggle(),this.currentMessage=e}.bind(this),!1),o.className=this.platformDetails.containerClass,this.platformDetails.includeClasses&&(o.className+=" "+n.className),this.platformDetails.insertionType===multisig.Content.InsertionType.AFTER?n.parentNode.insertBefore(o,n.nextSibling):n.insertBefore(o)}else a--,a>0&&window.setTimeout(function(){this.addToButtons(t,e,a)}.bind(this),multisig.Content.WAIT_TIME)};var multisigContent=new multisig.Content;multisigContent.init();
//# sourceMappingURL=contentscript.js.map
