"use strict";var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.CLASS_NAME_PREFIX="autocharlie-material-content-",autocharlie.constants.ClassName={MODAL_HEADER:autocharlie.constants.CLASS_NAME_PREFIX+"header",MODAL_FOOTER:autocharlie.constants.CLASS_NAME_PREFIX+"footer",MODAL_CONTENT:autocharlie.constants.CLASS_NAME_PREFIX+"content",MODAL_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"container",FAB:autocharlie.constants.CLASS_NAME_PREFIX+"fab",CARD:autocharlie.constants.CLASS_NAME_PREFIX+"card",LIGHT_BOX:autocharlie.constants.CLASS_NAME_PREFIX+"lightbox",DARK_BOX:autocharlie.constants.CLASS_NAME_PREFIX+"darkbox",BUTTON:autocharlie.constants.CLASS_NAME_PREFIX+"button",LEFT_ICON_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"left-icon-container",RIGHT_ICON_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"right-icon-container",INNER_HEADER:autocharlie.constants.CLASS_NAME_PREFIX+"inner-header",RIGHT_ICON:autocharlie.constants.CLASS_NAME_PREFIX+"right-icon",LEFT_ICON:autocharlie.constants.CLASS_NAME_PREFIX+"left-icon",TABS_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs",TAB:autocharlie.constants.CLASS_NAME_PREFIX+"tab",TAB_INDICATOR:autocharlie.constants.CLASS_NAME_PREFIX+"tab-indicator",TABS_DIVS_CONTAINER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div-container",TABS_DIV:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div",TABS_DIVS_INNER:autocharlie.constants.CLASS_NAME_PREFIX+"tabs-div-inner",PADDING:autocharlie.constants.CLASS_NAME_PREFIX+"padding"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Copy={SUBMIT_FEEDBACK:"Submit Feedback",SEND:"Send",FEEDBACK:"Feedback",EMAIL_ADDRESS:"Email Address"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.ID_NAME_PREFIX="autocharlie-material-content-",autocharlie.constants.Id={HEADER_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"header",FOOTER_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"footer",CONTENT_CONTAINER:autocharlie.constants.ID_NAME_PREFIX+"content",FEEBACK_INPUT:autocharlie.constants.ID_NAME_PREFIX+"feedback-input",FEEBACK_EMAIL:autocharlie.constants.ID_NAME_PREFIX+"feedback-email"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.IMAGE_FOLDER="images/",autocharlie.constants.Images={HEADER_LOGO:autocharlie.constants.IMAGE_FOLDER+"Logo.png",HEADER_HAMBURGER:autocharlie.constants.IMAGE_FOLDER+"Header_Hamburger.png",HEADER_CLOSE:autocharlie.constants.IMAGE_FOLDER+"Header_Close.png",HEADER_FEEDBACK:autocharlie.constants.IMAGE_FOLDER+"Header_Feedback.png"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Message={SEND_FEEDBACK:"sendFeedback"};var autocharlie=autocharlie||{};autocharlie.constants=autocharlie.constants||{},autocharlie.constants.Names={APP:"MultiSignature"};var autocharlie=autocharlie||{};autocharlie.services=autocharlie.services||{},autocharlie.services.PasteInterceptor=function(e,t,n){this.elem=e,this.callback=t,this.propagate=n||!1},autocharlie.services.PasteInterceptor.prototype.addEventListener=function(){this.elem.addEventListener("paste",function(e){this.propagate||e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/html")||"";this.callback(t)}.bind(this),!1)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Container=function(e){return this.containerDiv=document.createElement("div"),this.header=new autocharlie.ui.Header(this),this.content=new autocharlie.ui.Content(this),this.footer=new autocharlie.ui.Footer(this),this.containerDiv.className=autocharlie.constants.ClassName.MODAL_CONTAINER,e.appendChild(this.containerDiv),this.header.init(),this.content.init(),this.footer.init(),this.header.setHeader(autocharlie.constants.Names.APP),this},autocharlie.ui.Container.prototype.show=function(){this.containerDiv.style.display="block"},autocharlie.ui.Container.prototype.hide=function(){this.containerDiv.style.display="none"},autocharlie.ui.Container.prototype.get=function(){return this.containerDiv},autocharlie.ui.Container.prototype.getHeader=function(){return this.header},autocharlie.ui.Container.prototype.getContent=function(){return this.content},autocharlie.ui.Container.prototype.getFooter=function(){return this.footer};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Content=function(e){this.parent=e},autocharlie.ui.Content.prototype.clear=function(){return this.content.innerHTML="",this.content},autocharlie.ui.Content.prototype.remove=function(){this.content.parentNode.removeChild(this.content)},autocharlie.ui.Content.prototype.get=function(){return this.content},autocharlie.ui.Content.prototype.show=function(){this.content.style.display="block"},autocharlie.ui.Content.prototype.hide=function(){this.content.style.display="none"},autocharlie.ui.Content.prototype.init=function(){this.content=document.createElement("div"),this.content.className=autocharlie.constants.ClassName.MODAL_CONTENT,this.parent.get().appendChild(this.content)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Fab=function(e){this.parent=e},autocharlie.ui.Fab.prototype.clear=function(){return this.content.innerHTML="",this.content},autocharlie.ui.Fab.prototype.remove=function(){this.content.parentNode.removeChild(this.content)},autocharlie.ui.Fab.prototype.get=function(){return this.content},autocharlie.ui.Fab.prototype.show=function(){this.content.style.display="block"},autocharlie.ui.Fab.prototype.hide=function(){this.content.style.display="none"},autocharlie.ui.Fab.prototype.init=function(e){this.content=document.createElement("div"),this.content.innerHTML="+",this.content.className=autocharlie.constants.ClassName.FAB,this.parent.get().appendChild(this.content),e&&this.content.addEventListener("click",e,!1)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Footer=function(e){this.parent=e},autocharlie.ui.Footer.prototype.clear=function(){return this.modalFooter.innerHTML="",this.modalFooter},autocharlie.ui.Footer.prototype.remove=function(){this.modalFooter.parentNode.removeChild(this.modalFooter)},autocharlie.ui.Footer.prototype.get=function(){return this.modalFooter},autocharlie.ui.Footer.prototype.show=function(){this.modalFooter.style.display="block"},autocharlie.ui.Footer.prototype.hide=function(){this.modalFooter.style.display="none"},autocharlie.ui.Footer.prototype.init=function(){this.modalFooter=document.createElement("div"),this.modalFooter.className=autocharlie.constants.ClassName.MODAL_FOOTER,this.modalFooter.id=autocharlie.constants.Id.FOOTER_CONTAINER,this.parent.get().appendChild(this.modalFooter)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Header=function(e){this.parent=e},autocharlie.ui.Header.prototype.clear=function(){return this.innerHeader.innerHTML="",this.clearIcons(),this.header},autocharlie.ui.Header.prototype.remove=function(){this.header.parentNode.removeChild(this.header)},autocharlie.ui.Header.prototype.setHeader=function(e){if(e===autocharlie.constants.Names.APP){this.innerHeader.innerHTML="";var t=document.createElement("img");t.src=chrome.extension.getURL(autocharlie.constants.Images.HEADER_LOGO),this.innerHeader.appendChild(t)}else this.innerHeader.innerHTML=e;return this.header},autocharlie.ui.Header.prototype.clearIcons=function(){this.leftIcons.innerHTML="",this.rightIcons.innerHTML=""},autocharlie.ui.Header.prototype.addMenuBtn=function(e){this.addLeftIcon(autocharlie.constants.Images.HAMBURGER,e)},autocharlie.ui.Header.prototype.addLeftIcon=function(e,t,n){var i=document.createElement("img"),o="";return n&&(o+=" "+n),i.className=autocharlie.constants.ClassName.LEFT_ICON+o,i.src=chrome.extension.getURL(e),i.addEventListener("click",t),this.leftIcons.appendChild(i),i},autocharlie.ui.Header.prototype.addCloseButton=function(e){return this.addLeftIcon(autocharlie.constants.Images.HEADER_CLOSE,e)},autocharlie.ui.Header.prototype.addFeedbackButton=function(){this.addRightIcon(autocharlie.constants.Images.HEADER_FEEDBACK,function(){this.lightbox=new autocharlie.ui.LightBox(this.parent.get());var e=document.createElement("div");console.log("ids"),console.log(autocharlie.constants.Id);var t=new autocharlie.ui.Input(autocharlie.constants.Copy.FEEDBACK,autocharlie.constants.Id.FEEDBACK_INPUT);e.appendChild(t.get());var n=new autocharlie.ui.Input(autocharlie.constants.Copy.EMAIL_ADDRESS,autocharlie.constants.Id.FEEDBACK_EMAIL);e.appendChild(n.get());var i=document.createElement("button");i.className=autocharlie.constants.ClassName.BUTTON,i.innerHTML=autocharlie.constants.Copy.SEND,i.addEventListener("click",function(){var e=document.getElementById(autocharlie.constants.Id.FEEDBACK_EMAIL).value;console.log(e);var t=document.getElementById(autocharlie.constants.Id.FEEDBACK_INPUT).value,n={email:e,feedback:t};console.log(n),chrome.runtime.sendMessage({method:autocharlie.constants.Message.SEND_FEEDBACK,feedback:n},function(e){console.log(e),this.lightbox.remove()}.bind(this))}.bind(this),!1),e.appendChild(i),this.lightbox.init(e,autocharlie.constants.Copy.SUBMIT_FEEDBACK)}.bind(this))},autocharlie.ui.Header.prototype.addRightIcon=function(e,t,n){var i=document.createElement("img"),o="";return n&&(o+=" "+n),i.className=autocharlie.constants.ClassName.RIGHT_ICON+o,i.src=chrome.extension.getURL(e),i.addEventListener("click",t),this.rightIcons.appendChild(i),i},autocharlie.ui.Header.prototype.init=function(){this.header=document.createElement("div"),this.header.className=autocharlie.constants.ClassName.MODAL_HEADER,this.header.id=autocharlie.constants.Id.HEADER_CONTAINER,this.parent.get().appendChild(this.header),this.leftIcons=document.createElement("div"),this.leftIcons.className=autocharlie.constants.ClassName.LEFT_ICON_CONTAINER,this.leftIcons.id=autocharlie.constants.Id.HEADER_LEFT_ICONS,this.header.appendChild(this.leftIcons),this.innerHeader=document.createElement("div"),this.innerHeader.className=autocharlie.constants.ClassName.INNER_HEADER,this.innerHeader.id=autocharlie.constants.Id.INNER_HEADER,this.header.appendChild(this.innerHeader),this.rightIcons=document.createElement("div"),this.rightIcons.className=autocharlie.constants.ClassName.RIGHT_ICON_CONTAINER,this.rightIcons.id=autocharlie.constants.Id.HEADER_RIGHT_ICONS,this.header.appendChild(this.rightIcons)},autocharlie.ui.Header.prototype.get=function(){return this.header};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Input=function(e,t){return this.placeholder=e,this.container=document.createElement("div"),this.id=t,this.init(),this},autocharlie.ui.Input.ClassName={CONTAINER:"auto-char-input-container",LABEL:"auto-char-input-label",INPUT:"auto-char-input-input",FOCUSED:"auto-char-input-container-focused"},autocharlie.ui.Input.prototype.init=function(){this.container.className=autocharlie.ui.Input.ClassName.CONTAINER,this.container.innerHTML="",this.label=document.createElement("label"),this.label.className=autocharlie.ui.Input.ClassName.LABEL,this.label.innerHTML=this.placeholder,this.container.appendChild(this.label),this.input=document.createElement("input"),this.input.className=autocharlie.ui.Input.ClassName.INPUT,console.log("id is"),console.log(this.id),this.id&&(console.log("here"),this.input.id=this.id),this.container.appendChild(this.input)},autocharlie.ui.Input.prototype.get=function(){return this.container},autocharlie.ui.Input.prototype.getInput=function(){return this.input};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.LightBox=function(e,t,n){return this.container=e,this.closeCallback=t,this.darkBoxHide=n||!0,this},autocharlie.ui.LightBox.prototype.get=function(){return this.lightBox},autocharlie.ui.LightBox.prototype.show=function(){this.modalFooter.style.display="block"},autocharlie.ui.LightBox.prototype.remove=function(){this.container.removeChild(this.darkBox),this.container.removeChild(this.lightBox),this.closeCallback&&this.closeCallback()},autocharlie.ui.LightBox.prototype.init=function(e,t){this.lightBox=document.createElement("div"),this.lightBox.className=autocharlie.constants.ClassName.LIGHT_BOX,this.container.appendChild(this.lightBox),console.log(t),t&&""!==t&&(this.header=document.createElement("h3"),this.headerText=document.createElement("div"),this.headerText.innerHTML=t,this.header.appendChild(this.headerText),this.lightBox.appendChild(this.header)),e&&this.lightBox.appendChild(e),this.darkBox=document.createElement("div"),this.darkBox.className=autocharlie.constants.ClassName.DARK_BOX,this.darkBoxHide&&this.darkBox.addEventListener("click",function(){this.remove()}.bind(this),!1),this.container.appendChild(this.darkBox)};var autocharlie=autocharlie||{};autocharlie.ui=autocharlie.ui||{},autocharlie.ui.Tabs=function(e,t){this.insertionDiv=e,this.tabDetails=t,this.tabsContainer=document.createElement("ul"),this.tabsContainer.className=autocharlie.constants.ClassName.TABS_CONTAINER;for(var n=0;n<this.tabDetails.length;n++)this.createTabButton(n);this.indicator=document.createElement("div"),this.indicator.className=autocharlie.constants.ClassName.TAB_INDICATOR,this.indicator.style.width=100/this.tabDetails.length+"%",this.indicator.style.left="0px",this.tabsContainer.appendChild(this.indicator),this.insertionDiv.appendChild(this.tabsContainer),this.tabsDivContainer=document.createElement("div"),this.tabsDivContainer.className=autocharlie.constants.ClassName.TABS_DIVS_CONTAINER,this.tabsDivContainer.style.width="100%",this.tabsInnerDivContainer=document.createElement("div"),this.tabsInnerDivContainer.className=autocharlie.constants.ClassName.TABS_DIVS_INNER,this.tabsInnerDivContainer.style.width=100*t.length+"%",this.tabsDivContainer.appendChild(this.tabsInnerDivContainer);for(var i=0;i<t.length;i++){var o=t[i],s=document.createElement("div");t[i].containerDiv=s,s.className=autocharlie.constants.ClassName.TABS_DIV,s.appendChild(o.div),s.style.width=100/t.length+"%",s.style.left="0%",this.tabsInnerDivContainer.appendChild(s)}this.insertionDiv.appendChild(this.tabsDivContainer)},autocharlie.ui.Tabs.prototype.createTabButton=function(e){var t=this.tabDetails[e],n=document.createElement("li");this.tabDetails.button=n,n.className=autocharlie.constants.ClassName.TAB,n.innerHTML=t.name,n.style.width=100/this.tabDetails.length+"%",this.tabsContainer.appendChild(n),n.addEventListener("click",function(){var t=e*(100/this.tabDetails.length);this.indicator.style.left=t+"%";var n=e*(100/this.tabDetails.length);this.tabsInnerDivContainer.style.transform="translate3d(-"+n+"%, 0px, 0px)"}.bind(this))};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.constants=dyslexiaextension.constants||{},dyslexiaextension.constants.Message={TURN_ON_FONT:"turnOnFont",TURN_OFF_FONT:"turnOffFont",GET_FONT:"getFont",SEND_FEEDBACK:"sendFeedback",TURN_ON_BACKGROUND:"turnOnBackground",TURN_OFF_BACKGROUND:"turnOffBackground",GET_BACKGROUND:"getBackground",GET_INIT:"getInit"};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.Constants=dyslexiaextension.Constants||{},dyslexiaextension.Constants.CLASS_NAME_PREFIX="multi-sig-ext-",dyslexiaextension.Constants.ClassName={EXAMPLE:"example",SIG_HTML:dyslexiaextension.Constants.CLASS_NAME_PREFIX+"sig-html"};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.Constants=dyslexiaextension.Constants||{},dyslexiaextension.Constants.Copy={SIGNATURES:"Signatures",RULES:"Rules",RULES_PREVIEW:"Here you will be able to set rules as to which signature to use when.This is currently in development, if you are interested in this feature please message us using the feedback button in the top right with what you would like rules to do."};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.Constants=dyslexiaextension.Constants||{},dyslexiaextension.Constants.ID_PREFIX="multi-sig-ext-",dyslexiaextension.constants.Ids={TOOLBAR:dyslexiaextension.Constants.CLASS_NAME_PREFIX+"toobar",TEXTAREA:dyslexiaextension.Constants.CLASS_NAME_PREFIX+"textarea"};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.Constants=dyslexiaextension.Constants||{},dyslexiaextension.Constants.IMAGE_DIRECTORY="images/",dyslexiaextension.Constants.Images={HEADER_LOGO:dyslexiaextension.Constants.IMAGE_DIRECTORY+"Logo.png"};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.controllers=dyslexiaextension.controllers||{},dyslexiaextension.controllers.HomeCtrl=function(e){this.container=e.container,this.parent=e,this.content=this.container.getContent(),this.currentMessage=e.currentMessage,this.signatureList=null},dyslexiaextension.controllers.HomeCtrl.Copy={HELP:"Aid",EMPATHY:"Empathy",WELCOME:"Welcome to Dyslexia Extension find below a list of ways to make your internet experience a little easier or select the Empathy tab to experience ways to see through Dyslexics eyes.",EMPATHY_WELCOME:"Although its not possible to truly experience being Dyslexic, feel free to use the tools below to try.",FONTS:"Fonts",FONTS_HELP:'You can add these fonts to every element on the page, either click the "Add" button to add it to one webites or  turn on button which will add it to every website.',SCRIPTS:"Scripts",SCRIPTS_HELP:"These help show dyslexia by jumbling letters around",ADD_TO_PAGE:"Add to Page",BACKGROUND_COLOR:"Background Color Change"},dyslexiaextension.controllers.HomeCtrl.Class={ON_BUTTON:"on-button",OFF_BUTTON:"off-button",BACKGROUND_OFF_BUTTON:"bg-off-button",BACKGROUND_ON_BUTTON:"bg-on-button"},dyslexiaextension.controllers.HomeCtrl.FONTS=[{font:"Dyslexia-Extension-LexieReadable-Bold",name:"LexieReadable Bold"},{font:"Dyslexia-Extension-LexieReadable-Regular",name:"LexieReadable"},{font:"Dyslexia-Extension-Nisaba",name:"Nisaba"},{font:"Dyslexia-Extension-OpenDyslexic-Bold",name:"OpenDyslexic Bold"},{font:"Dyslexia-Extension-OpenDyslexic-BoldItalic",name:"OpenDyslexic Bold Italics"},{font:"Dyslexia-Extension-OpenDyslexic-Italic",name:"OpenDyslexic Italics"},{font:"Dyslexia-Extension-OpenDyslexic-Regular",name:"OpenDyslexic"},{font:"Dyslexia-Extension-OpenDyslexicAlta-Bold",name:"OpenDyslexic Alta Bold"},{font:"Dyslexia-Extension-OpenDyslexicAlta-BoldItalic",name:"OpenDyslexic Bold Italics"},{font:"Dyslexia-Extension-OpenDyslexicAlta-Italic",name:"OpenDyslexic Italics"},{font:"Dyslexia-Extension-OpenDyslexicAlta-Regular",name:"OpenDyslexic Alta"},{font:"Dyslexia-Extension-OpenDyslexicMono-Regular",name:"OpenDyslexic Mono"}],dyslexiaextension.controllers.HomeCtrl.PASTEL_COLORS=[{hex:"#FCFCE9",name:"Yellow"},{hex:"#E7FFDF",name:"Green"},{hex:"#ECF4FF",name:"Blue"},{hex:"#FFEEFB",name:"Pink"}],dyslexiaextension.controllers.HomeCtrl.EMPATHY_FONTS=[{font:"Dyslexia-Extension-DyslexicView",name:"Dyslexic View"}],dyslexiaextension.controllers.HomeCtrl.Urls={LOG_IN:"http://www.startuppilots.com/authentication/signin"},dyslexiaextension.controllers.HomeCtrl.prototype.init=function(){this.container.content.clear(),this.helpList=document.createElement("div"),this.helpList.className=autocharlie.constants.ClassName.PADDING,this.empathyList=document.createElement("div"),this.empathyList.className=autocharlie.constants.ClassName.PADDING;var e=[{name:dyslexiaextension.controllers.HomeCtrl.Copy.HELP,div:this.helpList,active:!0},{name:dyslexiaextension.controllers.HomeCtrl.Copy.EMPATHY,div:this.empathyList,active:!1}];new autocharlie.ui.Tabs(this.content.get(),e);this.setupHelpList(),this.setupEmpathyList()},dyslexiaextension.controllers.HomeCtrl.prototype.setupHelpList=function(){var e=document.createElement("p");e.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.WELCOME,this.helpList.appendChild(e);var t=document.createElement("h2");t.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.BACKGROUND_COLOR,this.helpList.appendChild(t);for(var n=document.createElement("table"),i=0;i<dyslexiaextension.controllers.HomeCtrl.PASTEL_COLORS.length;i++)this.addColorToUi(n,dyslexiaextension.controllers.HomeCtrl.PASTEL_COLORS[i]);this.helpList.appendChild(n);var o=document.createElement("h2");o.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.FONTS,this.helpList.appendChild(o);var s=document.createElement("p");s.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.FONTS_HELP,this.helpList.appendChild(s);for(var a=document.createElement("table"),l=0;l<dyslexiaextension.controllers.HomeCtrl.FONTS.length;l++)this.addFontToUi(a,dyslexiaextension.controllers.HomeCtrl.FONTS[l]);this.helpList.appendChild(a)},dyslexiaextension.controllers.HomeCtrl.prototype.addColorToUi=function(e,t){var n=document.createElement("tr");e.appendChild(n);var i=document.createElement("td");i.innerHTML=t.name,n.appendChild(i);var o=document.createElement("td");n.appendChild(o);var s=document.createElement("button");s.innerHTML="+",o.appendChild(s),s.addEventListener("click",function(){console.log(this.parent),this.parent.setBackground(t.hex),this.parent.insertOntoBody()}.bind(this),!1);var a=document.createElement("td");n.appendChild(a);var l=document.createElement("button");l.innerHTML="ON",l.className=dyslexiaextension.controllers.HomeCtrl.Class.ON_BUTTON,a.appendChild(l),this.parent.getBackground()===t.hex&&(l.style.display="none");var r=document.createElement("td");n.appendChild(r);var c=document.createElement("button");c.innerHTML="OFF",this.parent.getBackground()!==t.hex&&(c.style.display="none"),c.className=dyslexiaextension.controllers.HomeCtrl.Class.BACKGROUND_OFF_BUTTON,r.appendChild(c),l.addEventListener("click",function(){this.parent.setBackground(t.hex),this.parent.insertOntoBody(),chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.TURN_ON_BACKGROUND,color:t},function(){console.log("Color Set")});for(var e=document.getElementsByClassName(dyslexiaextension.controllers.HomeCtrl.Class.BACKGROUND_ON_BUTTON),n=0;n<e.length;n++)e[n].style.display="block";for(var i=document.getElementsByClassName(dyslexiaextension.controllers.HomeCtrl.Class.BACKGROUND_OFF_BUTTON),o=0;o<i.length;o++)i[o].style.display="none";l.style.display="none",c.style.display="block"}.bind(this)),c.addEventListener("click",function(){this.parent.removeBackground(),chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.TURN_OFF_BACKGROUND},function(){console.log("Font Removed")}),l.style.display="block",c.style.display="none"}.bind(this))},dyslexiaextension.controllers.HomeCtrl.prototype.addFontToUi=function(e,t){var n=document.createElement("tr");e.appendChild(n);var i=document.createElement("td");i.innerHTML=t.name,n.appendChild(i);var o=document.createElement("td");n.appendChild(o);var s=document.createElement("button");s.innerHTML="+",o.appendChild(s),s.addEventListener("click",function(){console.log(this.parent),this.parent.setFont(t.font),this.parent.insertOntoBody()}.bind(this),!1);var a=document.createElement("td");n.appendChild(a);var l=document.createElement("button");l.innerHTML="ON",l.className=dyslexiaextension.controllers.HomeCtrl.Class.ON_BUTTON,a.appendChild(l),this.parent.getFont()===t.font&&(l.style.display="none");var r=document.createElement("td");n.appendChild(r);var c=document.createElement("button");c.innerHTML="OFF",this.parent.getFont()!==t.font&&(c.style.display="none"),c.className=dyslexiaextension.controllers.HomeCtrl.Class.OFF_BUTTON,r.appendChild(c),l.addEventListener("click",function(){this.parent.setFont(t.font),this.parent.insertOntoBody(),chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.TURN_ON_FONT,font:t},function(){console.log("Font Set")});for(var e=document.getElementsByClassName(dyslexiaextension.controllers.HomeCtrl.Class.ON_BUTTON),n=0;n<e.length;n++)e[n].style.display="block";for(var i=document.getElementsByClassName(dyslexiaextension.controllers.HomeCtrl.Class.OFF_BUTTON),o=0;o<i.length;o++)i[o].style.display="none";l.style.display="none",c.style.display="block"}.bind(this)),c.addEventListener("click",function(){this.parent.removeFont(),chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.TURN_OFF_FONT},function(){console.log("Font Removed")}),l.style.display="block",c.style.display="none"}.bind(this))},dyslexiaextension.controllers.HomeCtrl.prototype.setupEmpathyList=function(){var e=document.createElement("p");e.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.EMPATHY_WELCOME,this.empathyList.appendChild(e);var t=document.createElement("h2");t.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.FONTS,this.empathyList.appendChild(t);var n=document.createElement("p");n.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.FONTS_HELP,this.empathyList.appendChild(n);for(var i=document.createElement("table"),o=0;o<dyslexiaextension.controllers.HomeCtrl.EMPATHY_FONTS.length;o++)this.addFontToUi(i,dyslexiaextension.controllers.HomeCtrl.EMPATHY_FONTS[o]);this.empathyList.appendChild(i);var s=document.createElement("h2");s.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.SCRIPTS,this.empathyList.appendChild(s);var a=document.createElement("p");a.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.SCRIPTS_HELP,this.empathyList.appendChild(a);var l=document.createElement("button");l.innerHTML=dyslexiaextension.controllers.HomeCtrl.Copy.ADD_TO_PAGE,l.addEventListener("click",function(){var e=document.createElement("script");e.crossorigin="anonymous",e.src=chrome.extension.getURL("scripts/helperscripts/jquery-2.2.2.min.js");var t=document.getElementsByTagName("head")[0];e.onload=function(){var e=document.createElement("script");e.src=chrome.extension.getURL("scripts/helperscripts/dyslexiasimulation.js"),t.appendChild(e)},t.appendChild(e)},!1),this.empathyList.appendChild(l)};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.modules=dyslexiaextension.modules||{},dyslexiaextension.modules.Tts=function(){this.voices=null,this.voice=null,this.canHighlightText=!0,this.elToRead=null,this.elBeingRead=null,this.textBeingRead=null,this.utterance=null,this.lastHoveredEl=null,this.buttonEl=null,this.buttonShown=!1},console.log("Read-To-Me: Loaded extension"),dyslexiaextension.modules.Tts.PREFERRED_VOICE_NAME="Samantha",dyslexiaextension.modules.Tts.VOICE_SPEED=.8,dyslexiaextension.modules.Tts.HIGHLIGHT_ID="read-to-me-highlight",dyslexiaextension.modules.Tts.HOVER_DURATION_MS=1200,dyslexiaextension.modules.Tts.init=function(){window.speechSynthesis.onvoiceschanged=function(){this.voices||(console.log("Read-To-Me: Loading voices"),this.voices=window.speechSynthesis.getVoices(),console.log("Read-To-Me: Loaded voices"),this.runExtension())}.bind(this)},dyslexiaextension.modules.Tts.runExtension=function(){console.log("Read-To-Me: Running extension"),this.setVoice(),this.renderButton(),this.attachListeners()},dyslexiaextension.modules.Tts.setVoice=function(){if(!this.voice){if(console.log("Read-To-Me: Setting voice"),!this.voices||0===this.voices.length)return void console.log("Read-To-Me: ERROR no voices available.");for(var e=null,t=0;t<this.voices.length;t++){if(this.voices[t].name===dyslexiaextension.modules.Tts.PREFERRED_VOICE_NAME&&this.voices[t].localService){this.voice=this.voices[t],console.log("Read-To-Me: Using preferred voice "+dyslexiaextension.modules.Tts.PREFERRED_VOICE_NAME+".");break}!e&&this.voices[t].localService&&(e=this.voices[t])}this.voice||(e?(this.voice=this.firstLocalVoice,console.log("Read-To-Me: Preferred voice "+dyslexiaextension.modules.Tts.PREFERRED_VOICE_NAME+" unavailable. Using "+this.voice.name+".")):(this.voices=this.voices[t],this.canHighlightText=!1,console.log("Read-To-Me: ERROR no local voices available, text highlights disabled.")))}},dyslexiaextension.modules.Tts.renderButton=function(){this.buttonEl=document.createElement("div"),this.buttonEl.id="read-to-me-button",document.body.appendChild(this.buttonEl)},dyslexiaextension.modules.Tts.attachListeners=function(){console.log("Read-To-Me: Attaching listeners"),this.buttonEl.addEventListener("click",function(){this.readEl(this.elToRead),this.elToRead=null,this.hideButton()}.bind(this)),document.body.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("scroll",function(){this.buttonShown&&this.hideButtonFast()}.bind(this))},dyslexiaextension.modules.Tts.handleMouseMove=function(e){var t=document.elementFromPoint(e.clientX,e.clientY);if(t!==this.lastHoveredEl){this.lastHoveredEl=t;var n=this.lastHoveredEl;window.setTimeout(function(){if(this.lastHoveredEl!==n&&this.lastHoveredEl!==this.buttonEl)return void this.hideButton();var e=this.getTextNode(n);e&&this.showButtonNear(e)}.bind(this),dyslexiaextension.modules.Tts.HOVER_DURATION_MS)}},dyslexiaextension.modules.Tts.hideButton=function(){this.buttonEl.style.opacity=0,this.buttonEl.style.pointerEvents="none",this.buttonShown=!1},dyslexiaextension.modules.Tts.hideButtonFast=function(){this.buttonEl.style.display="none",this.buttonEl.style.opacity=0,this.buttonEl.style.pointerEvents="none",window.setTimeout(function(){this.buttonEl.style.display="",this.buttonShown=!1}.bind(this),0)},dyslexiaextension.modules.Tts.showButtonNear=function(e){var t=e.parentNode.getBoundingClientRect();buttonEl.style.left=t.left+"px",buttonEl.style.top=t.top+t.height/2+"px",buttonEl.style.opacity=1,buttonEl.style.pointerEvents="auto",this.elToRead=e,this.buttonShown=!0};var getTextNode=function(e){if(e.nodeType===Node.TEXT_NODE)return e;for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeType===Node.TEXT_NODE)return e.childNodes[t]};dyslexiaextension.modules.Tts.readEl=function(e){if(this.utterance)return this.utterance.onend=function(){this.cleanUp(),this.readEl(e)}.bind(this),void window.speechSynthesis.cancel();if(!e)return void this.hideButton();var t=this.getTextNode(e);if(!this.textNode)return void console.log("Read-To-Me: Nothing to read, clicked element and its children have no text nodes.");var n=t.textContent.trim();return n&&0!==n.length?(this.textBeingRead=t.textContent,this.elBeingRead=t,this.utterance=new SpeechSynthesisUtterance(this.textBeingRead),this.utterance.voice=this.voice,this.utterance.rate=dyslexiaextension.modules.Tts.VOICE_SPEED,this.utterance.onboundary=function(e){this.highlightNextPhrase(e.charIndex)}.bind(this),this.utterance.onend=function(e){this.cleanUp()}.bind(this),this.utterance.onerror=function(e){console.log("Read-To-Me: Error while reading."),this.cleanUp()}.bind(this),void window.speechSynthesis.speak(this.utterance)):void console.log("Read-To-Me: Nothing to read, clicked element has empty text content.")},dyslexiaextension.modules.Tts.cleanUp=function(){this.removeHighlights(),this.elBeingRead=null,this.textBeingRead=null,this.utterance=null,this.elToRead=null},dyslexiaextension.modules.Tts.removeHighlights=function(){if(canHighlightText){var e=document.querySelector("#"+HIGHLIGHT_ID);if(e){var t=e.parentNode;if(e.insertAdjacentHTML("beforebegin",e.textContent),e.remove(),t.normalize(),this.utterance)for(var n=0;n<t.childNodes.length;n++)if(t.childNodes[n].nodeType===Node.TEXT_NODE){elBeingRead=t.childNodes[n];break}}}},dyslexiaextension.modules.Tts.highlightNextPhrase=function(e){if(this.canHighlightText){if(!this.utterance)return void console.log("abort at "+e);this.removeHighlights();var t=this.textBeingRead.substr(e),n=e+t.search(/[ .!?]/);n=e>n?this.textBeingRead.length:n;var i=document.createElement("span");i.id=dyslexiaextension.modules.Tts.HIGHLIGHT_ID;var o=document.createRange();o.setStart(this.elBeingRead,e),o.setEnd(this.elBeingRead,n),o.surroundContents(i)}};var dyslexiaextension=dyslexiaextension||{};dyslexiaextension.Content=function(){this.showing=!1,this.font=""},dyslexiaextension.Content.prototype.init=function(){console.log("Init"),this.scrappedBody=document.getElementsByTagName("body")[0],this.addComposeListener(),this.container=new autocharlie.ui.Container(this.scrappedBody),this.ctrl=new dyslexiaextension.controllers.HomeCtrl(this),this.container.header.addFeedbackButton(),this.container.header.addCloseButton(this.hide.bind(this)),
chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.GET_INIT},function(e){console.log("Response"),console.log(e),""!==e?(this.font=e.font,this.background=e.background,this.reading=e.reading,this.insertOntoBody()):(this.font="",this.background="",this.reading="")}.bind(this)),this.addListener()},dyslexiaextension.Content.prototype.toggle=function(e){e&&e.stopPropagation(),this.showing?this.hide():this.show()},dyslexiaextension.Content.prototype.addListener=function(){chrome.runtime.onMessage.addListener(function(e){e&&"browserActionClicked"===e.method&&this.toggle()}.bind(this))},dyslexiaextension.Content.prototype.show=function(){this.showing=!0,this.container.show(),this.ctrl.init()},dyslexiaextension.Content.prototype.hide=function(){this.showing=!1,this.container.hide()},dyslexiaextension.Content.prototype.getEnabled=function(){chrome.runtime.sendMessage({method:dyslexiaextension.constants.Message.GET_ENABLED},function(e){e?(this.enabled=e.enabled,this.font=e.font):console.log("Error getting codes, please refresh")}.bind(this))},dyslexiaextension.Content.prototype.checkLoad=function(){document.addEventListener("DOMContentLoaded",this.init.bind(this),!1)},dyslexiaextension.Content.prototype.insertOntoBody=function(){this.insertFontOntoElements(this.scrappedBody)},dyslexiaextension.Content.prototype.insertFontOntoElements=function(e){if(e){this.insertFontOntoElement(e);try{for(var t=e.getElementsByTagName("*"),n=0;n<t.length;n++)this.insertFontOntoElement(t[n])}catch(i){}}},dyslexiaextension.Content.prototype.setFont=function(e){this.font=e},dyslexiaextension.Content.prototype.getFont=function(){return this.font},dyslexiaextension.Content.prototype.setBackground=function(e){this.background=e},dyslexiaextension.Content.prototype.getBackground=function(){return this.background},dyslexiaextension.Content.prototype.insertFontOntoElement=function(e){var t=document.defaultView.getComputedStyle(e,null);e.style&&(""!==this.background&&"rgb(255, 255, 255)"===t.backgroundColor&&(e.style.backgroundColor=this.background),""===this.font?e.removeAttribute("font-family"):("Dyslexia-Extension-DyslexicView"===this.font,e.style.fontFamily=this.font))},dyslexiaextension.Content.prototype.addComposeListener=function(){document.addEventListener("DOMNodeInserted",this.subtreeModifed.bind(this),!1)},dyslexiaextension.Content.prototype.removeFont=function(){this.font="",this.insertOntoBody()},dyslexiaextension.Content.prototype.removeBackground=function(){this.background="",this.insertOntoBody()},dyslexiaextension.Content.prototype.subtreeModifed=function(e){var t=e.target;t&&this.insertFontOntoElements(t)};var dyslexiaextensionContent=new dyslexiaextension.Content;dyslexiaextensionContent.init();
//# sourceMappingURL=contentscript.js.map
